<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nazmul Alam">
<meta name="dcterms.date" content="2023-06-13">

<title>FDA Bioanalytical method validation guidlines- summary – Nazmul Alam</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<link href="../..//images/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-005320388bf5d7a2f26bed4cf184bc04.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../custom.scss">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Nazmul Alam</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> <i class="bi bi-person-circle" role="img">
</i> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv/index.html"> <i class="bi bi-file-earmark-check" role="img">
</i> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../pubs/index.html"> <i class="bi bi-journals" role="img">
</i> 
<span class="menu-text">Pubs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog/index.html"> <i class="bi bi-pencil-square" role="img">
</i> 
<span class="menu-text">Posts</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">FDA Bioanalytical method validation guidlines- summary</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">FDA</div>
                <div class="quarto-category">MV</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Nazmul Alam </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 13, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">Background</a></li>
  <li><a href="#scope" id="toc-scope" class="nav-link" data-scroll-target="#scope">Scope</a></li>
  </ul></li>
  <li><a href="#general-principles" id="toc-general-principles" class="nav-link" data-scroll-target="#general-principles">General Principles</a>
  <ul class="collapse">
  <li><a href="#method-development" id="toc-method-development" class="nav-link" data-scroll-target="#method-development">Method Development</a></li>
  </ul></li>
  <li><a href="#method-validation" id="toc-method-validation" class="nav-link" data-scroll-target="#method-validation">Method Validation</a>
  <ul class="collapse">
  <li><a href="#full-validation" id="toc-full-validation" class="nav-link" data-scroll-target="#full-validation">Full Validation</a></li>
  <li><a href="#partial-validation" id="toc-partial-validation" class="nav-link" data-scroll-target="#partial-validation">Partial Validation</a></li>
  <li><a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation">Cross Validation</a></li>
  </ul></li>
  <li><a href="#chromatography" id="toc-chromatography" class="nav-link" data-scroll-target="#chromatography">Chromatography</a>
  <ul class="collapse">
  <li><a href="#reference-standards" id="toc-reference-standards" class="nav-link" data-scroll-target="#reference-standards">Reference Standards</a></li>
  <li><a href="#validation" id="toc-validation" class="nav-link" data-scroll-target="#validation">Validation</a>
  <ul class="collapse">
  <li><a href="#selectivity" id="toc-selectivity" class="nav-link" data-scroll-target="#selectivity">Selectivity</a></li>
  <li><a href="#specificity" id="toc-specificity" class="nav-link" data-scroll-target="#specificity">Specificity</a></li>
  <li><a href="#matrix-effect" id="toc-matrix-effect" class="nav-link" data-scroll-target="#matrix-effect">Matrix Effect</a></li>
  <li><a href="#calibration-curve-and-range" id="toc-calibration-curve-and-range" class="nav-link" data-scroll-target="#calibration-curve-and-range">Calibration Curve and Range</a></li>
  <li><a href="#accuracy-and-precision" id="toc-accuracy-and-precision" class="nav-link" data-scroll-target="#accuracy-and-precision">Accuracy and Precision</a></li>
  <li><a href="#carryover" id="toc-carryover" class="nav-link" data-scroll-target="#carryover">Carryover</a></li>
  <li><a href="#dilution-linearity-and-hook-effect" id="toc-dilution-linearity-and-hook-effect" class="nav-link" data-scroll-target="#dilution-linearity-and-hook-effect">Dilution Linearity and Hook Effect</a></li>
  <li><a href="#stability" id="toc-stability" class="nav-link" data-scroll-target="#stability">Stability</a></li>
  <li><a href="#reinjection-reproducibility" id="toc-reinjection-reproducibility" class="nav-link" data-scroll-target="#reinjection-reproducibility">Reinjection Reproducibility</a></li>
  </ul></li>
  <li><a href="#study-sample-analysis" id="toc-study-sample-analysis" class="nav-link" data-scroll-target="#study-sample-analysis">Study Sample Analysis</a>
  <ul class="collapse">
  <li><a href="#analytical-run" id="toc-analytical-run" class="nav-link" data-scroll-target="#analytical-run">Analytical Run</a></li>
  <li><a href="#acceptance-criteria-for-an-analytical-run" id="toc-acceptance-criteria-for-an-analytical-run" class="nav-link" data-scroll-target="#acceptance-criteria-for-an-analytical-run">2. Acceptance Criteria for an Analytical Run</a></li>
  <li><a href="#calibration-range" id="toc-calibration-range" class="nav-link" data-scroll-target="#calibration-range">Calibration Range</a></li>
  <li><a href="#reanalysis-of-study-samples" id="toc-reanalysis-of-study-samples" class="nav-link" data-scroll-target="#reanalysis-of-study-samples">Reanalysis of Study Samples</a></li>
  <li><a href="#reinjection-of-study-samples" id="toc-reinjection-of-study-samples" class="nav-link" data-scroll-target="#reinjection-of-study-samples">Reinjection of Study Samples</a></li>
  <li><a href="#integration-of-chromatograms" id="toc-integration-of-chromatograms" class="nav-link" data-scroll-target="#integration-of-chromatograms">Integration of Chromatograms</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#incurred-sample-reanalysis" id="toc-incurred-sample-reanalysis" class="nav-link" data-scroll-target="#incurred-sample-reanalysis">Incurred sample reanalysis</a></li>
  <li><a href="#partial-validation-and-cross-validation" id="toc-partial-validation-and-cross-validation" class="nav-link" data-scroll-target="#partial-validation-and-cross-validation">Partial Validation and Cross Validation</a>
  <ul class="collapse">
  <li><a href="#partial-validation-1" id="toc-partial-validation-1" class="nav-link" data-scroll-target="#partial-validation-1">Partial Validation</a></li>
  <li><a href="#cross-validation-1" id="toc-cross-validation-1" class="nav-link" data-scroll-target="#cross-validation-1">Cross validation</a></li>
  </ul></li>
  <li><a href="#additinoal-consideratoins" id="toc-additinoal-consideratoins" class="nav-link" data-scroll-target="#additinoal-consideratoins">Additinoal Consideratoins</a>
  <ul class="collapse">
  <li><a href="#methods-for-analytes-that-are-also-endogenous-molecules" id="toc-methods-for-analytes-that-are-also-endogenous-molecules" class="nav-link" data-scroll-target="#methods-for-analytes-that-are-also-endogenous-molecules">Methods for Analytes That Are Also Endogenous Molecules</a></li>
  <li><a href="#parallelism" id="toc-parallelism" class="nav-link" data-scroll-target="#parallelism">Parallelism</a></li>
  <li><a href="#recovery" id="toc-recovery" class="nav-link" data-scroll-target="#recovery">Recovery</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is based based on the original FDA <a href="https://www.fda.gov/regulatory-information/search-fda-guidance-documents/m10-bioanalytical-method-validation-and-study-sample-analysis">guideline</a></p>
</div>
</div>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<p>This guidance provides recommendations for validating bioanalytical methods for drug quantification and analysis. Follow these principles for consistent and high-quality results in drug development and approval.</p>
<ul>
<li><p>Validate bioanalytical methods to demonstrate suitability for intended purpose</p></li>
<li><p>Alternative approaches may be used if scientifically justified and approved by regulatory authorities</p></li>
<li><p>Consult regulatory authorities for significant changes in method validation approaches</p></li>
<li><p>This guidance replaces the ICH draft guidance for industry M10 Bioanalytical Method Validation, issued on June 27, 2019.</p></li>
</ul>
</section>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<ul>
<li><p>Reliable concentration measurements of chemical and biological drugs and their metabolites in biological matrices are crucial for drug development and regulatory decisions.</p></li>
<li><p>Validated bioanalytical methods are necessary to ensure accurate and consistent results.</p></li>
<li><p>These methods should be well-characterized, appropriately validated, and thoroughly documented.</p></li>
<li><p>The results of studies using bioanalytical methods contribute to regulatory decisions on drug product safety and efficacy.</p></li>
</ul>
</section>
<section id="scope" class="level2">
<h2 class="anchored" data-anchor-id="scope">Scope</h2>
<ul>
<li><p>The guidance is applicable to the bioanalytical methods used to measure concentrations of chemical and biological drug(s) and their metabolite(s) in biological samples (e.g., blood, plasma, serum, other body fluids or tissues) obtained in</p></li>
<li><p>nonclinical toxicokinetic (TK) studies conducted according to the principles of Good Laboratory Practice (GLP),</p></li>
<li><p>nonclinical pharmacokinetic (PK) studies conducted as surrogates for clinical studies, and all phases of clinical trials,</p></li>
<li><p>including comparative bioavailability/bioequivalence (BA/BE) studies, in regulatory submissions.</p></li>
</ul>
</section>
</section>
<section id="general-principles" class="level1">
<h1>General Principles</h1>
<section id="method-development" class="level2">
<h2 class="anchored" data-anchor-id="method-development">Method Development</h2>
<ul>
<li><p>The purpose of bioanalytical method development is to define the method’s design, operating conditions, limitations, and suitability for its intended purpose.</p></li>
<li><p>Understand the analyte of interest, including its physicochemical properties, metabolism, distribution, and protein binding.</p></li>
<li><p>Determine if any prior analytical methods are available.</p></li>
<li><p>Identify the procedures and conditions involved in quantifying the analyte.</p></li>
<li><p>Characterize reference standards, critical reagents, calibration curve, QCs, selectivity and specificity, sensitivity, accuracy, precision, recovery, stability of the analyte, and MRD.</p></li>
<li><p>Validate the method to ensure it is suitable for analyzing study samples.</p></li>
</ul>
</section>
</section>
<section id="method-validation" class="level1">
<h1>Method Validation</h1>
<section id="full-validation" class="level2">
<h2 class="anchored" data-anchor-id="full-validation">Full Validation</h2>
<ul>
<li><p>Validation of bioanalytical methods is crucial to ensure accurate and reliable results.</p></li>
<li><p>A full validation should be performed when establishing a new method for quantifying an analyte in clinical or nonclinical studies, implementing a reported analytical method, or repurposing a commercial kit for bioanalytical use in drug development.</p></li>
<li><p>The validation process should include selectivity, specificity, matrix effect, calibration curve, range, accuracy, precision, carryover, dilution integrity, stability, and reinjection reproducibility for chromatographic methods.</p></li>
<li><p>The matrix used for validation should match the matrix of the study samples, including anticoagulants and additives. Surrogate matrices may be acceptable if identical matrices are difficult to obtain.</p></li>
<li><p>The choice of surrogate matrix should be scientifically justified. Matrix differences within species are generally not considered different during validation.</p></li>
<li><p>A detailed written description of the method and validation procedure should be established beforehand, in the form of a protocol, study plan, report, notebook, or SOP.</p></li>
</ul>
</section>
<section id="partial-validation" class="level2">
<h2 class="anchored" data-anchor-id="partial-validation">Partial Validation</h2>
<ul>
<li><p>Partial validation can evaluate modifications to a previously validated analytical method.</p></li>
<li><p>The extent and nature of the changes made to the method determine the items to be included in a partial validation.</p></li>
<li><p>Partial validation can range from a single accuracy and precision determination to a nearly full validation.</p></li>
<li><p>The goal of partial validation is to ensure the modified method produces accurate and reliable results.</p></li>
</ul>
</section>
<section id="cross-validation" class="level2">
<h2 class="anchored" data-anchor-id="cross-validation">Cross Validation</h2>
<p>Cross validation is required to demonstrate how the reported data are related when multiple bioanalytical methods and/or multiple bioanalytical laboratories are involved</p>
</section>
</section>
<section id="chromatography" class="level1">
<h1>Chromatography</h1>
<section id="reference-standards" class="level2">
<h2 class="anchored" data-anchor-id="reference-standards">Reference Standards</h2>
<ul>
<li><p>Prepare calibration standards and QCs by spiking a blank biological matrix with the analyte(s) of interest using separate stock solutions of reference standards.</p></li>
<li><p>Add a suitable internal standard (IS) to all calibration standards, QCs, and study samples during sample processing, unless justified otherwise.</p></li>
<li><p>Ensure the reference standard is well characterized, of high quality, and obtained from an authentic and traceable source.</p></li>
<li><p>Use an identical reference standard to the analyte, or an established form of known quality if not possible.</p></li>
<li><p>Suitable reference standards include compendial, commercially available, or sufficiently characterized standards prepared in-house or by an external organization.</p></li>
<li><p>Use a CoA or equivalent alternative to ensure quality and provide information on the purity, storage conditions, retest/expiration date, and batch number of the reference standard.</p></li>
<li><p>When using MS detection, use a stable isotope-labeled analyte as the IS whenever possible, ensuring high isotope purity and no isotope exchange reaction occurs.</p></li>
<li><p>Only prepare <strong>stock and working solutions</strong> from reference standards within the stability period documented in the CoA (either expiration date or retest date).</p></li>
</ul>
</section>
<section id="validation" class="level2">
<h2 class="anchored" data-anchor-id="validation">Validation</h2>
<section id="selectivity" class="level3">
<h3 class="anchored" data-anchor-id="selectivity">Selectivity</h3>
<ul>
<li><p>Selectivity is the ability of an analytical method to measure the analyte in the presence of interfering substances in the blank biological matrix.</p></li>
<li><p>To evaluate selectivity, blank samples should be obtained from at least six individual sources/lots.</p></li>
<li><p>Selectivity for the internal standard (IS) should also be evaluated.</p></li>
<li><p>The evaluation should show no significant response from interfering components at the retention time of the analyte or IS in the blank samples.</p></li>
<li><p>Interfering component responses should not be more than 20% of the analyte response at the LLOQ and not more than 5% of the IS response in the LLOQ sample for each matrix.</p></li>
<li><p>Lipemic matrices should be tested using a representative matrix with high levels of triglycerides obtained from donors or spiked with triglycerides.</p></li>
<li><p>Hemolyzed matrices should be tested using a visibly detectable hemolyzed sample obtained by spiking matrix with hemolyzed whole blood (at least 2% V/V).</p></li>
<li><p>Lipemic and hemolyzed matrix testing is not necessary for nonclinical studies unless the drug impacts lipid metabolism or is administered in a particular animal strain that is hyperlipidemic.</p></li>
</ul>
</section>
<section id="specificity" class="level3">
<h3 class="anchored" data-anchor-id="specificity">Specificity</h3>
<ul>
<li><p>Specificity refers to a bioanalytical method’s ability to detect and differentiate the analyte from other substances.</p></li>
<li><p>This includes <strong>related substances, metabolites, isomers, impurities, degradation products, and concomitant medications.</strong></p></li>
<li><p>The impact of related substances should be evaluated during method validation or in predose study samples.</p></li>
<li><p>LC-MS based methods can assess the impact of related substances by comparing molecular weight and chromatographic separation.</p></li>
<li><p>Interfering components should not contribute more than 20% of the analyte response at the LLOQ or 5% of the IS response in the LLOQ sample.</p></li>
<li><p>Back-conversion of metabolites into the parent analyte should be evaluated, especially for unstable metabolites.</p></li>
<li><p>Partial validation should be performed if needed, and the impact on study results should be discussed in the Bioanalytical Report.</p></li>
</ul>
</section>
<section id="matrix-effect" class="level3">
<h3 class="anchored" data-anchor-id="matrix-effect">Matrix Effect</h3>
<ul>
<li><p>A matrix effect is when the response of an analyte is altered due to unknown components in the sample matrix.</p></li>
<li><p>During method validation, the matrix effect should be evaluated between different sources/lots.</p></li>
<li><p>To evaluate the matrix effect, at least three replicates of low and high quality controls should be analyzed using matrix from at least six different sources/lots.</p></li>
<li><p>Accuracy should be within ±15% of the nominal concentration and precision should not be greater than 15% for each matrix source/lot evaluated.</p></li>
<li><p>The matrix effect should also be evaluated in relevant patient populations or special populations (e.g.&nbsp;hepatically impaired or renally impaired) when available.</p></li>
<li><p>Hemolyzed or lipemic matrix samples should be evaluated for matrix effect on a case-by-case basis, especially if these conditions are expected to occur in the study.</p></li>
</ul>
</section>
<section id="calibration-curve-and-range" class="level3">
<h3 class="anchored" data-anchor-id="calibration-curve-and-range">Calibration Curve and Range</h3>
<ul>
<li><p>The calibration curve shows the relationship between the analyte concentration and the analytical platform’s response.</p></li>
<li><p>Calibration standards, prepared by spiking known amounts of analyte into the matrix, make up the calibration curve.</p></li>
<li><p>The calibration range is defined by the lowest and highest calibration standards, known as the LLOQ and ULOQ.</p></li>
<li><p>A calibration curve should be generated with a blank sample, a zero sample, and at least six concentration levels of calibration standards.</p></li>
<li><p>The regression model, weighting scheme, and transformation should be determined during method validation.</p></li>
<li><p>The accuracy of the back-calculated concentrations of each calibration standard should be within ±20% of the nominal concentration at the LLOQ and within ±15% at all other levels.</p></li>
<li><p>At least 75% of the calibration standards should meet the above criteria.</p></li>
<li><p>If a calibration standard does not meet the criteria, it should be rejected, and the calibration curve should be reevaluated.</p></li>
<li><p>The calibration curve should be prepared using freshly spiked calibration standards in at least one assessment.</p></li>
<li><p>Frozen calibration standards can be used within their defined period of stability.</p></li>
</ul>
</section>
<section id="accuracy-and-precision" class="level3">
<h3 class="anchored" data-anchor-id="accuracy-and-precision">Accuracy and Precision</h3>
<section id="preparation-of-quality-control-samples" class="level4">
<h4 class="anchored" data-anchor-id="preparation-of-quality-control-samples">Preparation of quality control samples</h4>
<ul>
<li><p>Prepare quality control samples by spiking matrix with a known quantity of analyte.</p></li>
<li><p>Store the QCs under the same conditions as study samples and analyze them to validate the analytical method.</p></li>
<li><p>Use separate stock solutions for calibration standards and QCs to avoid biased estimations.</p></li>
<li><p>Verify the accuracy and stability of stock solutions if calibration standards and QCs are prepared from the same solution.</p></li>
<li><p>Use a single source of blank matrix that is free of interference or matrix effects.</p></li>
<li><p>Prepare QCs at a minimum of 4 concentration levels within the calibration curve range.</p></li>
<li><p>QCs should include LLOQ, low QC, medium QC, and high QC.</p></li>
<li><p>Analyze low, medium, and high QCs in duplicate for non-accuracy and precision validation runs.</p></li>
<li><p>Use QCs and calibration standards to determine acceptance or rejection of a run.</p></li>
</ul>
</section>
<section id="evaluation-of-accuracy-and-precision" class="level4">
<h4 class="anchored" data-anchor-id="evaluation-of-accuracy-and-precision">Evaluation of accuracy and precision</h4>
<ul>
<li><p>To determine accuracy and precision, analyze QCs within each run and between runs.</p></li>
<li><p>Evaluate accuracy and precision using at least three replicates per run at each QC concentration level in at least six runs over 2 or more days.</p></li>
<li><p>Report within-run accuracy and precision data for each run and calculate an overall estimate if criteria are not met in all runs.</p></li>
<li><p>Calculate between-run precision and accuracy by combining data from all runs.</p></li>
<li><p>Within-run and between-run accuracy should be within ±20% of nominal values, except for LLOQ and ULOQ which should be within ±25%.</p></li>
<li><p>Within-run and between-run precision should not exceed 20%, except at LLOQ and ULOQ where it should not exceed 25%.</p></li>
<li><p>For non-validation runs, at least 2/3 of total QCs and 50% at each concentration level should be within ±20% of nominal values.</p></li>
<li><p>Evaluate total error (accuracy and precision) and ensure it does not exceed 30% (40% at LLOQ and ULOQ).</p></li>
</ul>
</section>
</section>
<section id="carryover" class="level3">
<h3 class="anchored" data-anchor-id="carryover">Carryover</h3>
<ul>
<li><p>Investigate potential carryover in analytical platform by placing blank samples after ULOQ calibration standard.</p></li>
<li><p>Response of blank samples should be below LLOQ to avoid carryover.</p></li>
</ul>
</section>
<section id="dilution-linearity-and-hook-effect" class="level3">
<h3 class="anchored" data-anchor-id="dilution-linearity-and-hook-effect">Dilution Linearity and Hook Effect</h3>
<ul>
<li><p>Assay range may require study samples to be diluted for accurate measurements</p></li>
<li><p>Dilution linearity should be assessed to confirm accuracy and avoid hook effect</p></li>
<li><p>Same matrix as study sample should be used for QC preparation</p></li>
<li><p>Dilution QC should be generated with analyte concentration above ULOQ and tested at different dilution factors</p></li>
<li><p>Response reduction (hook effect) should be checked and mitigated if necessary</p></li>
<li><p>Mean concentration should be within ±20% of nominal concentration after correction for dilution</p></li>
<li><p>Precision should not exceed 20%</p></li>
<li><p>Dilution factors used in study sample analysis should be within validated range.</p></li>
</ul>
</section>
<section id="stability" class="level3">
<h3 class="anchored" data-anchor-id="stability">Stability</h3>
<ul>
<li><p>Stability evaluations ensure that sample preparation, processing, analysis, and storage conditions do not affect analyte concentration.</p></li>
<li><p>Storage and analytical conditions used in stability tests should reflect those used for study samples.</p></li>
<li><p>Validation of storage periods should be performed on QCs stored for equal or longer periods than study samples.</p></li>
<li><p>Low and high concentration QCs should be analyzed at time zero and after storage conditions are evaluated.</p></li>
<li><p>QCs should be analyzed against a calibration curve obtained from freshly spiked calibration standards and QCs.</p></li>
<li><p>Freeze-thaw stability should be demonstrated with valid justification provided for macromolecules.</p></li>
<li><p>QCs should be adjusted to represent the actual sample concentration range if consistently higher than ULOQ.</p></li>
<li><p>Fixed dose combination products require stability tests with matrix spiked with all dosed compounds.</p></li>
<li><p>Bench top, freeze-thaw, and long-term stability should be studied for all analytes.</p></li>
<li><p>Stability at one temperature can be extrapolated to lower temperatures for chemical drugs.</p></li>
<li><p>Biological drugs can use a bracketing approach for stability testing.</p></li>
</ul>
</section>
<section id="reinjection-reproducibility" class="level3">
<h3 class="anchored" data-anchor-id="reinjection-reproducibility">Reinjection Reproducibility</h3>
<ul>
<li><p>To ensure the method’s reproducibility, multiple measurements of the QCs are necessary.</p></li>
<li><p>Precision and accuracy are evaluated through these measurements.</p></li>
<li><p>If samples are reinjected due to instrument interruptions or equipment failure, reinjection reproducibility should be assessed.</p></li>
<li><p>This evaluation confirms the processed samples’ viability and supports their storage before reinjection.</p></li>
</ul>
</section>
</section>
<section id="study-sample-analysis" class="level2">
<h2 class="anchored" data-anchor-id="study-sample-analysis">Study Sample Analysis</h2>
<ul>
<li><p>Validation of bioanalytical method should be completed before analyzing study samples.</p></li>
<li><p>Some parameters may be completed later, such as long-term stability.</p></li>
<li><p>The validated analytical method should be used to process study samples, QCs, and calibration standards.</p></li>
<li><p>Documentation should follow recommendations in Table 1.</p></li>
<li><p>Bioanalytical method validation should be completed before submitting data to regulatory authorities.</p></li>
</ul>
<section id="analytical-run" class="level3">
<h3 class="anchored" data-anchor-id="analytical-run">Analytical Run</h3>
<ul>
<li><p>An analytical run should include a blank sample, calibration standards, QC samples (low, medium, and high), and study samples.</p></li>
<li><p>The calibration standards should have at least six concentration levels.</p></li>
<li><p>The number of QC samples should be at least 5% of the number of study samples, or two sets of QC samples.</p></li>
<li><p>The blank sample should not be included in the calibration curve calculation.</p></li>
<li><p>The placement of QC samples should ensure the accuracy and precision of the entire run, with study samples bracketed by QC samples.</p></li>
<li><p>Microtiter plates are often used for LBAs.</p></li>
<li><p>Each plate should contain its own set of calibration standards and QC samples.</p></li>
<li><p>If sample capacity is limited, sets of calibration standards may be placed on the first and last plates, but QC samples should be placed on every plate.</p></li>
<li><p>QC samples should be placed before and after the study samples on each plate.</p></li>
<li><p>The acceptance criteria for an analytical run should be met for each QC sample and calibration curve.</p></li>
<li><p>The calibration standards should be combined for one regression analysis to calculate concentrations.</p></li>
<li><p>If the combined calibration curve does not meet acceptance criteria, the entire run fails.</p></li>
</ul>
</section>
<section id="acceptance-criteria-for-an-analytical-run" class="level3">
<h3 class="anchored" data-anchor-id="acceptance-criteria-for-an-analytical-run">2. Acceptance Criteria for an Analytical Run</h3>
<ul>
<li><p>Acceptance criteria for an analytical run must be defined in the protocol, study plan, or SOP.</p></li>
<li><p>If a run contains multiple batches, acceptance criteria should be applied to the whole run and individual batches.</p></li>
<li><p>Calibration standards in a failed batch should not be used to support the acceptance of other batches within the analytical run.</p></li>
<li><p>Calibration standards should have back-calculated concentrations within ±20% of the nominal value, except for LLOQ and ULOQ, which should be within ±25%.</p></li>
<li><p>At least 75% of calibration standards with a minimum of 6 concentration levels should meet this criterion, excluding anchor calibration standards.</p></li>
<li><p>If a calibration standard fails, it should be rejected, and a new regression analysis should be performed without it.</p></li>
<li><p>If the LLOQ is rejected, the new lower limit should be the next lowest acceptable calibration standard, and if the highest calibration standard is rejected, the new upper limit should be the next acceptable highest calibration standard.</p></li>
<li><p>Each run should contain at least three levels of QCs (low, medium, and high), and at least 2/3 of the QCs and 50% at each concentration level should be within ±20% of the nominal value.</p></li>
<li><p>Overall mean accuracy and precision of the QCs of all accepted runs should be calculated and reported in the analytical report.</p></li>
<li><p>If the overall mean accuracy and/or precision exceeds 20%, additional investigations should be conducted to determine the cause(s) of this deviation.</p></li>
</ul>
</section>
<section id="calibration-range" class="level3">
<h3 class="anchored" data-anchor-id="calibration-range">Calibration Range</h3>
<ul>
<li><p>If the expected range of analyte concentrations in study samples is narrow, adjust the calibration curve range, QC concentrations, or add new QC levels to reflect the concentrations of the study samples.</p></li>
<li><p>If an unexpected clustering of study samples at one end of the calibration curve is encountered during sample analysis, stop the analysis and narrow the calibration curve range, revise QC concentrations, or add new QC levels before continuing with sample analysis.</p></li>
<li><p>If a large number of study sample concentrations are above the ULOQ, adjust the calibration curve range and QC levels or dilute the samples according to validated methods.</p></li>
<li><p>Ensure at least two QC levels fall within the range of concentrations measured in study samples.</p></li>
<li><p>If the calibration curve range is changed, revalidate the bioanalytical method to ensure accuracy and precision.</p></li>
</ul>
</section>
<section id="reanalysis-of-study-samples" class="level3">
<h3 class="anchored" data-anchor-id="reanalysis-of-study-samples">Reanalysis of Study Samples</h3>
<ul>
<li><p>Predefine reasons for reanalysis of study samples, number of replicates, and decision criteria in protocol or SOP before analysis begins</p></li>
<li><p>Do not reject valid result for one analyte if another analyte fails acceptance criteria in samples with multiple analytes</p></li>
<li><p>Report and discuss number of samples (and percentage) that have been reanalyzed in Bioanalytical Report</p></li>
<li><p>Reasons for study sample reanalysis may include rejected analytical run, significant difference in IS response, concentration above ULOQ, concentration below revised LLOQ, improper sample injection or equipment malfunction, diluted sample below LLOQ, quantifiable analyte levels in pre-dose or control samples, or poor chromatography</p></li>
<li><p>Do not reanalyze study samples for PK reasons in comparative BA/BE studies to avoid bias</p></li>
<li><p>Identify reanalyzed samples in Bioanalytical Report with initial value, reason for reanalysis, values obtained in reanalyzes, final accepted value, and justification for acceptance; provide summary table of total number of samples reanalyzed for each reason</p></li>
<li><p>In cases where first analysis yields nonreportable result, single reanalysis is sufficient; replicate determinations required if sample volume allows for confirmation of value</p></li>
<li><p>Safety of trial subjects takes precedence over any other aspect of trial; may need to reanalyze specific study samples for safety investigation</p></li>
</ul>
</section>
<section id="reinjection-of-study-samples" class="level3">
<h3 class="anchored" data-anchor-id="reinjection-of-study-samples">Reinjection of Study Samples</h3>
<ul>
<li><p>Reprocessed samples can be reinjected in case of equipment failure, but only if reinjection reproducibility has been demonstrated during validation or provided in the Bioanalytical Report.</p></li>
<li><p>It is not recommended to reinject a full analytical run or individual calibration standards or QCs simply because they failed without any identified analytical cause.</p></li>
<li><p>The focus should be on identifying the root cause of the failure rather than blindly reinjecting samples.</p></li>
</ul>
</section>
<section id="integration-of-chromatograms" class="level3">
<h3 class="anchored" data-anchor-id="integration-of-chromatograms">Integration of Chromatograms</h3>
<ul>
<li><p>A study plan, protocol, or SOP should outline chromatogram integration and reintegration procedures.</p></li>
<li><p>Any deviations from these procedures should be explained in the Bioanalytical Report.</p></li>
<li><p>The Bioanalytical Report should include a list of chromatograms that required reintegration and the reasons for it.</p></li>
<li><p>Both original and reintegrated chromatograms and integration results should be kept for future reference.</p></li>
<li><p>All of this information should be submitted in the Bioanalytical Report for comparative BA/BE studies.</p></li>
</ul>
</section>
</section>
</section>
<section id="incurred-sample-reanalysis" class="level1">
<h1>Incurred sample reanalysis</h1>
<ul>
<li><p>Incurred sample reanalysis (ISR) is used to verify the reliability of reported sample analyte concentrations.</p></li>
<li><p>ISR should be performed in nonclinical studies at least once per species, in all pivotal comparative BA/BE studies, and in first clinical trials in subjects.</p></li>
<li><p>The extent of ISR depends on the analyte and study samples, but as a minimum, 10% of samples should be reanalyzed if the total number of samples is less than or equal to 1000, and 10% of the first 1000 samples plus 5% of the number of samples that exceed 1000 should be assessed if the total number of samples is greater than 1000.</p></li>
<li><p>Samples should not be pooled, and ISR samples and QCs should be processed and analyzed in the same manner as in the original analysis.</p></li>
<li><p>The percent difference between the initial concentration and the concentration measured during the repeat analysis should be within ±20% for chromatographic methods and within ±30% for LBAs for at least 2/3 of the repeats.</p></li>
<li><p>If the overall ISR results fail the acceptance criteria, an investigation should be conducted and the causes remediated.</p></li>
<li><p>All aspects of ISR evaluations should be documented to allow reconstruction of the study and any investigations.</p></li>
<li><p>Individual samples that are quite different from the original value (e.g., 50%, “flyers”) should not trigger reanalysis of the original sample and do not need to be investigated.</p></li>
<li><p>ISR sample data should not replace the original study sample data.</p></li>
</ul>
<p>The percent difference between the initial concentration and the concentration measured during the repeat analysis should be calculated in relation to their mean value.</p>
</section>
<section id="partial-validation-and-cross-validation" class="level1">
<h1>Partial Validation and Cross Validation</h1>
<section id="partial-validation-1" class="level2">
<h2 class="anchored" data-anchor-id="partial-validation-1">Partial Validation</h2>
<p>Partial validations assess modifications to fully validated bioanalytical methods. It can be a minimal validation with only one accuracy and precision determination or a nearly full validation. If stability is established at one facility, it does not need to be repeated at another facility.</p>
<p>For chromatographic methods, typical modifications include:</p>
<ul>
<li><p>Analytical site change using the same method</p></li>
<li><p>Change in analytical method (e.g., detection systems, platform)</p></li>
<li><p>Change in sample processing procedures</p></li>
<li><p>Change in sample volume (e.g., smaller volume for pediatric samples)</p></li>
<li><p>Changes to the calibration concentration range</p></li>
<li><p>Change in anticoagulant (not changes in counter-ion) in biological fluids</p></li>
<li><p>Change from one matrix within a species to another or changes to the species within the matrix</p></li>
<li><p>Change in storage conditions</p></li>
</ul>
</section>
<section id="cross-validation-1" class="level2">
<h2 class="anchored" data-anchor-id="cross-validation-1">Cross validation</h2>
<p>Cross validation is necessary to show the relationship between reported data when multiple bioanalytical methods and/or laboratories are involved. It is required in the following situations:</p>
<ul>
<li><p>Data is obtained from different validated methods within a study.</p></li>
<li><p>Data is obtained from different laboratories using the same bioanalytical method.</p></li>
<li><p>Data is obtained from different validated methods across studies that will be combined or compared to support dosing regimens, safety, efficacy, and labeling decisions.</p></li>
</ul>
<p>Cross validation is not generally required if data from different validated methods are not combined across studies. It should be done before analyzing study samples if possible. Cross validation should involve measuring the same set of QCs in triplicate and study samples (if available) that span the concentration range with both methods or in both laboratories.</p>
<p>Bias can be assessed using Bland-Altman plots or Deming regression. Other methods like the concordance correlation coefficient may also be used. Alternatively, concentration vs.&nbsp;time curves for study samples can be plotted for samples analyzed by each method to assess bias.</p>
<p>Using multiple bioanalytical methods in one comparative BA/BE study is strongly discouraged.</p>
</section>
</section>
<section id="additinoal-consideratoins" class="level1">
<h1>Additinoal Consideratoins</h1>
<section id="methods-for-analytes-that-are-also-endogenous-molecules" class="level2">
<h2 class="anchored" data-anchor-id="methods-for-analytes-that-are-also-endogenous-molecules">Methods for Analytes That Are Also Endogenous Molecules</h2>
<p>Analyzing analytes that are also endogenous molecules can be challenging as accuracy may be affected when the method cannot differentiate between the therapeutic agent and the endogenous molecule. Additionally, endogenous levels of the analyte may vary due to various factors. This section covers approaches for assessing concentrations of analytes that are also endogenous molecules, excluding biomarkers.</p>
<p>Calibration standards and QCs should ideally use the same biological matrix as study samples, free of matrix effect and interference. The biological matrix chosen should have low endogenous concentration to ensure a good signal-to-noise ratio.</p>
<p>If matrices without interference are unavailable, the following approaches can be used to calculate analyte concentration in study samples: surrogate matrix, surrogate analyte, background subtraction, and standard addition.</p>
<dl>
<dt>Surrogate Matrix Approach</dt>
<dd>
<p>Substitute the matrix for calibration standards with a surrogate matrix, ranging from simple buffers to stripped matrices or matrices from other species.</p>
</dd>
<dt>Surrogate Analyte Approach</dt>
<dd>
<p>Use stable isotope labeled analytes as surrogate standards in mass spectrometric methods to construct the calibration curve, assuming physicochemical properties are the same except for molecular weight. Ensure the response factor is close to unity and constant over the entire calibration range.</p>
</dd>
<dt>Background Subtraction Approach</dt>
<dd>
<p>Subtract the endogenous analyte concentration observed in a pooled/representative matrix from the concentration observed in spiked standards, then use the net differences to construct the calibration curve. Diluting blank matrices before spiking may cause different recoveries and matrix effects, which should be considered during validation.</p>
</dd>
<dt>Standard Addition Approach</dt>
<dd>
<p>Use only for analytical platforms with linear responses. Divide study samples into equal volume aliquots, and spike all but one with varying amounts of analyte standards to construct a calibration curve. Determine the endogenous blank concentration or study sample concentration as the negative x-intercept of the standard calibration curve prepared in that particular study sample.</p>
</dd>
</dl>
<p>Validation of an analytical method for an endogenous analyte requires careful consideration of several factors:</p>
<ol type="1">
<li><p>Quality Control Samples: Use matrices with low levels of interfering endogenous analyte and prepare QC samples that resemble study samples. Use both unspiked and spiked matrices to cover a range of concentrations.</p></li>
<li><p>Selectivity, Recovery, and Matrix Effects: Assess selectivity by analyzing matrices from multiple donors. Recovery and matrix effects should be evaluated for calibration standards and study samples, and the impact of different matrices should be assessed.</p></li>
<li><p>Parallelism: Ensure that changes in response per given changes in analyte concentrations are equivalent for the surrogate and authentic biological matrix.</p></li>
<li><p>Accuracy and Precision: Meet criteria for accuracy and precision specified in relevant sections. Use the formula to calculate accuracy when QCs are spiked with the authentic analyte in the matrix containing endogenous levels of the analyte.</p></li>
<li><p>Stability: Investigate stability with the authentic analyte in the authentic biological matrix and with unspiked/endogenous QCs, as well as spiked low QC and high QCs. If using a surrogate matrix, demonstrate stability for the analyte in the surrogate matrix.</p></li>
</ol>
</section>
<section id="parallelism" class="level2">
<h2 class="anchored" data-anchor-id="parallelism">Parallelism</h2>
<ul>
<li><p>Parallelism is the relationship between the calibration curve and diluted study samples.</p></li>
<li><p>It’s important to evaluate parallelism when interference from a matrix component is suspected.</p></li>
<li><p>Results should be included in the Bioanalytical Report.</p></li>
<li><p>Parallelism may differ between patient populations and should be tested during analysis of study samples.</p></li>
<li><p>Dilution series should have at least three concentrations with consistent back calculated concentrations.</p></li>
<li><p>Results that pass the 30% CV criterion should still be monitored for nonparallel trends.</p></li>
<li><p>A priori procedures should be defined for reporting nonparallel results.</p></li>
</ul>
</section>
<section id="recovery" class="level2">
<h2 class="anchored" data-anchor-id="recovery">Recovery</h2>
<ul>
<li><p>Sample extraction methods require evaluation of recovery (extraction efficiency).</p></li>
<li><p>Recovery should be reported as a percentage of the known analyte amount carried through the extraction and processing steps.</p></li>
<li><p>Compare analyte response in a spiked sample with response in a blank sample to determine recovery.</p></li>
<li><p>Recovery doesn’t need to be 100%, but consistency is important for analyte and IS (if used).</p></li>
<li><p>Perform recovery experiments at low, medium, and high concentrations.</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>